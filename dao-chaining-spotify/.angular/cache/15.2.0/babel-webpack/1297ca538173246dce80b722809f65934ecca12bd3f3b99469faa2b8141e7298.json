{"ast":null,"code":"import { ContractService } from \"../../services/contract.service\";\nimport { select } from \"@ngrx/store\";\nimport { Subject } from \"rxjs\";\nimport * as fromUser from \"../../selectors/user.selectors\";\nimport { selectSongIdList } from \"../../selectors/song-list.selector\";\nimport * as fromOrganization from \"../../selectors/organization.selectors\";\nimport { takeUntil } from \"rxjs/operators\";\nimport { connectUser } from \"../../actions/user.actions\";\nimport { SongListComponent } from \"../../components/song-list/song-list.component\";\nimport { TRACKS } from \"../../components/song-list/tracks\";\nimport { createOrganization, getOrganization, donate, checkAdmin } from \"../../actions/organization.actions\";\nimport { first } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/store\";\nimport * as i2 from \"../../services/contract.service\";\nimport * as i3 from \"../../services/user.services\";\nimport * as i4 from \"../../components/song-list/song-list.component\";\nfunction HomeComponent_img_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 12);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate(\"src\", ctx_r0.songSelected.image, i0.ɵɵsanitizeUrl);\n    i0.ɵɵpropertyInterpolate2(\"alt\", \"\", ctx_r0.songSelected.artist, \" - \", ctx_r0.songSelected.album, \"\");\n  }\n}\nfunction HomeComponent_img_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 13);\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate2(\"alt\", \"\", ctx_r1.songSelected.artist, \" - \", ctx_r1.songSelected.album, \"\");\n  }\n}\nfunction HomeComponent_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"app-connect\", 14);\n    i0.ɵɵlistener(\"connect\", function HomeComponent_div_24_Template_app_connect_connect_1_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.onConnect());\n    });\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction HomeComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 15)(1, \"app-create-org\", 16);\n    i0.ɵɵlistener(\"create\", function HomeComponent_div_25_Template_app_create_org_create_1_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.onCreate($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction HomeComponent_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 17);\n  }\n}\nexport let HomeComponent = /*#__PURE__*/(() => {\n  class HomeComponent {\n    constructor(store$, contractService, userService, songListAddtoCart) {\n      this.store$ = store$;\n      this.contractService = contractService;\n      this.userService = userService;\n      this.songListAddtoCart = songListAddtoCart;\n      this.unsubscribe$ = new Subject();\n      this.loading = false;\n      this.display$ = this.store$.pipe(select(fromUser.selectConnectionStatus));\n      this.selectedOrganization$ = this.store$.pipe(select(fromOrganization.selectOrganizationDetails));\n      this.isAdmin$ = this.store$.pipe(select(fromOrganization.selectAdminStatus));\n      this.songList$ = this.store$.pipe(select(selectSongIdList));\n    }\n    ngOnInit() {\n      // login\n      this.loading = true;\n      this.userService.getAll().pipe(first()).subscribe(users => {\n        this.loading = false;\n        this.users = users;\n      });\n      this.display$.pipe(takeUntil(this.unsubscribe$)).subscribe(res => {\n        this.connected = res;\n      });\n      this.selectedOrganization$.pipe(takeUntil(this.unsubscribe$)).subscribe(data => {\n        this.organizationDetails = data;\n      });\n      this.isAdmin$.pipe(takeUntil(this.unsubscribe$)).subscribe(boolean => {\n        this.isAdmin = boolean;\n      });\n      this.songList$.pipe(takeUntil(this.unsubscribe$)).subscribe(id => {\n        this.songId = id;\n      });\n      this.songSelected = TRACKS.find(x => x.id == this.songId);\n    }\n    onConnect() {\n      this.store$.dispatch(connectUser());\n    }\n    onCreate(form) {\n      const org = {\n        orgID: form.id,\n        payableWallet: form.walletAddress,\n        orgName: form.name,\n        tokenAddress: form.tokenAddress\n      };\n      this.store$.dispatch(createOrganization({\n        organization: org\n      }));\n    }\n    onGet(form) {\n      const orgID = form.id;\n      this.store$.dispatch(getOrganization({\n        id: orgID\n      }));\n      this.store$.dispatch(checkAdmin({\n        id: orgID\n      }));\n    }\n    onDonate(form) {\n      this.store$.dispatch(donate({\n        id: form.id,\n        amount: form.amount,\n        tip: form.tip\n      }));\n    }\n    onPause(data) {\n      console.log(data);\n      // TODO move to ngrx effect?\n      this.contractService.pauseOrganization(data.id, data.causeIds);\n    }\n    onUnpause(data) {\n      console.log(data);\n      // TODO move to ngrx effect?\n      this.contractService.unpauseOrganization(data.id, data.causeIds);\n    }\n    onAdd(data) {\n      console.log(data);\n      // incorporate uDonate isAdmin function?\n      // TODO move to ngrx effect?\n      this.contractService.addNewOrganizationAdmin(data.address, data.id);\n    }\n    onRemove(data) {\n      console.log(data);\n      // incorporate uDonate isAdmin function?\n      // TODO move to ngrx effect?\n      this.contractService.removeOrganizationAdmin(data.address, data.id);\n    }\n    getSong() {\n      return this.songSelected;\n    }\n    ngOnDestroy() {\n      this.unsubscribe$.next();\n      this.unsubscribe$.complete();\n    }\n  }\n  HomeComponent.ɵfac = function HomeComponent_Factory(t) {\n    return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i2.ContractService), i0.ɵɵdirectiveInject(i3.UsersService), i0.ɵɵdirectiveInject(i4.SongListComponent));\n  };\n  HomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HomeComponent,\n    selectors: [[\"app-home\"]],\n    features: [i0.ɵɵProvidersFeature([ContractService, SongListComponent])],\n    decls: 27,\n    vars: 12,\n    consts: [[1, \"card\", \"mt-4\"], [1, \"back\"], [\"routerLink\", \"/\"], [\"mat-card-sm-image\", \"\", 3, \"src\", \"alt\", 4, \"ngIf\"], [\"mat-card-sm-image\", \"\", \"src\", \"../assets/music.png\", 3, \"alt\", 4, \"ngIf\"], [\"for\", \"track-name\"], [1, \"track-price\"], [1, \"card-body\"], [3, \"ngClass\"], [4, \"ngIf\"], [\"class\", \"container-fluid\", \"style\", \"width: 100%;\", 4, \"ngIf\"], [\"class\", \"spinner-border spinner-border-sm\", 4, \"ngIf\"], [\"mat-card-sm-image\", \"\", 3, \"src\", \"alt\"], [\"mat-card-sm-image\", \"\", \"src\", \"../assets/music.png\", 3, \"alt\"], [3, \"connect\"], [1, \"container-fluid\", 2, \"width\", \"100%\"], [3, \"create\"], [1, \"spinner-border\", \"spinner-border-sm\"]],\n    template: function HomeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"button\", 1)(2, \"a\", 2);\n        i0.ɵɵtext(3, \" < Back\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(4, \"mat-card\")(5, \"mat-card-header\")(6, \"mat-card-title-group\")(7, \"mat-card-title\");\n        i0.ɵɵtext(8);\n        i0.ɵɵpipe(9, \"uppercase\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(10, HomeComponent_img_10_Template, 1, 3, \"img\", 3);\n        i0.ɵɵtemplate(11, HomeComponent_img_11_Template, 1, 2, \"img\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"mat-card-content\")(13, \"div\")(14, \"label\", 5);\n        i0.ɵɵtext(15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"p\");\n        i0.ɵɵtext(17);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"div\", 6)(19, \"span\");\n        i0.ɵɵtext(20);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelement(21, \"mat-divider\");\n        i0.ɵɵelementStart(22, \"div\", 7)(23, \"div\", 8);\n        i0.ɵɵtemplate(24, HomeComponent_div_24_Template, 2, 0, \"div\", 9);\n        i0.ɵɵtemplate(25, HomeComponent_div_25_Template, 2, 0, \"div\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(26, HomeComponent_div_26_Template, 1, 0, \"div\", 11);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(9, 10, ctx.songSelected.album));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.songSelected.image != \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.songSelected.image == \"\");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\"Artist: \", ctx.songSelected.artist, \"\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.songSelected.description);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"Price( ETH ): \", ctx.songSelected.price, \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngClass\", !ctx.connected ? \"section\" : \"mat-app-background-connected section-connected\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.connected);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.connected);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n      }\n    },\n    styles: [\"[_nghost-%COMP%]{position:absolute;top:150px;width:95%;padding-left:16px;padding-right:16px}.section[_ngcontent-%COMP%]{height:100%;display:grid;justify-content:center;align-content:center;padding-top:16px}.section-connected[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:left;align-content:center;color:#000}.mat-app-background[_ngcontent-%COMP%]{background:#0b7465}.mat-app-background-connected[_ngcontent-%COMP%]{background:#0b7465;color:#fff;padding:16px}.container[_ngcontent-%COMP%]{margin:30px}.card-body[_ngcontent-%COMP%]{display:flex;justify-content:center}button.back[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:15px;margin-bottom:15px;padding:10px;border:2px solid #3e3d3d;background-color:#3e3d3d;cursor:pointer;border-radius:4px;height:30px}button.back[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;font-weight:700}.mat-card[_ngcontent-%COMP%]{width:100%;background:#fff}.mat-card-header[_ngcontent-%COMP%]{justify-content:space-between}.mat-card-title-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%}.mat-card-title[_ngcontent-%COMP%]{color:#25052d;font-size:50px;height:50px;align-content:center;display:flex;justify-content:center;flex-direction:column}.mat-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;margin-top:16px}.mat-card-content[_ngcontent-%COMP%]{color:#25052d;font-size:20px;padding:16px}.track-price[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;font-size:20px;color:#0b7465;flex-direction:column;align-items:flex-end}\"]\n  });\n  return HomeComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}